<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8"/>
  <title>soagen: A Structure-of-Arrays generator for C++ | soagen Structure-of-Arrays for C++</title>
  <link href="favicon-light.png" rel="icon" type="image/png"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="#cb4b16" name="theme-color"/>
  <link href="poxy/poxy.css" referrerpolicy="no-referrer" rel="stylesheet"/>
  <link href="pages.css" referrerpolicy="no-referrer" rel="stylesheet"/>
  <script src="poxy/poxy.js"></script>
  <script>initialize_theme("light");</script>
  <meta content="soagen" name="twitter:title"/>
  <meta content="soagen" property="og:title"/>
  <meta content="soagen" itemprop="name"/>
  <meta content="Mark Gillard" name="author"/>
  <meta content="Mark Gillard" property="article:author"/>
  <meta content="Structure-of-Arrays for C++" name="description"/>
  <meta content="Structure-of-Arrays for C++" name="twitter:description"/>
  <meta content="Structure-of-Arrays for C++" property="og:description"/>
  <meta content="Structure-of-Arrays for C++" itemprop="description"/>
  <meta content="telephone=no" name="format-detection"/>
  <meta content="Poxy v0.13.4" name="generator"/>
  <meta content="strict-origin-when-cross-origin" name="referrer"/>
</head>
<body class="poxy-has-toc">
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a class="m-col-t-8 m-col-m-none m-left-m" href="index.html" id="m-navbar-brand">soagen <span class="m-thin">Structure-of-Arrays for C++</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a class="m-doc-search-icon" href="#search" onclick="return showSearch()" title="Search"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z" id="m-doc-search-icon-path"></path>
        </svg></a>
        <a href="#navigation" id="m-navbar-show" title="Show navigation"></a>
        <a href="#" id="m-navbar-hide" title="Hide navigation"></a>
      </div>
      <div class="m-col-t-12 m-show-m m-col-m-none m-right-m" id="m-navbar-collapse">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a class="poxy-icon twitter poxy-external" href="https://twitter.com/marzer8789" target="_blank" title="Twitter"><svg id="poxy-icon-twitter" version="1.1" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg"><path d="M 50.0625 10.4375 C 48.214844 11.257813 46.234375 11.808594 44.152344 12.058594 C 46.277344 10.785156 47.910156 8.769531 48.675781 6.371094 C 46.691406 7.546875 44.484375 8.402344 42.144531 8.863281 C 40.269531 6.863281 37.597656 5.617188 34.640625 5.617188 C 28.960938 5.617188 24.355469 10.21875 24.355469 15.898438 C 24.355469 16.703125 24.449219 17.488281 24.625 18.242188 C 16.078125 17.8125 8.503906 13.71875 3.429688 7.496094 C 2.542969 9.019531 2.039063 10.785156 2.039063 12.667969 C 2.039063 16.234375 3.851563 19.382813 6.613281 21.230469 C 4.925781 21.175781 3.339844 20.710938 1.953125 19.941406 C 1.953125 19.984375 1.953125 20.027344 1.953125 20.070313 C 1.953125 25.054688 5.5 29.207031 10.199219 30.15625 C 9.339844 30.390625 8.429688 30.515625 7.492188 30.515625 C 6.828125 30.515625 6.183594 30.453125 5.554688 30.328125 C 6.867188 34.410156 10.664063 37.390625 15.160156 37.472656 C 11.644531 40.230469 7.210938 41.871094 2.390625 41.871094 C 1.558594 41.871094 0.742188 41.824219 -0.0585938 41.726563 C 4.488281 44.648438 9.894531 46.347656 15.703125 46.347656 C 34.617188 46.347656 44.960938 30.679688 44.960938 17.09375 C 44.960938 16.648438 44.949219 16.199219 44.933594 15.761719 C 46.941406 14.3125 48.683594 12.5 50.0625 10.4375 Z" fill="currentColor"></path></svg></a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="5">
            <li><a class="poxy-icon repo github poxy-external" href="https://github.com/marzer/soagen" target="_blank" title="View on GitHub"><svg id="poxy-icon-repo" version="1.1" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg"><path d="M25,1.23a24.37,24.37,0,0,0-7.7,47.5C18.51,49,19,48.2,19,47.56s0-2.12,0-4.15c-6.78,1.47-8.21-3.27-8.21-3.27C9.61,37.33,8,36.58,8,36.58c-2.21-1.51.17-1.48.17-1.48a5.12,5.12,0,0,1,3.73,2.51c2.17,3.72,5.7,2.65,7.09,2a5.25,5.25,0,0,1,1.55-3.26c-5.41-.61-11.1-2.7-11.1-12A9.41,9.41,0,0,1,12,17.79a8.75,8.75,0,0,1,.24-6.45s2-.66,6.7,2.49a23.1,23.1,0,0,1,12.2,0c4.66-3.15,6.7-2.49,6.7-2.49A8.75,8.75,0,0,1,38,17.79a9.41,9.41,0,0,1,2.51,6.54c0,9.36-5.7,11.42-11.13,12a5.83,5.83,0,0,1,1.65,4.51c0,3.26,0,5.89,0,6.69,0,.65.44,1.41,1.68,1.17A24.38,24.38,0,0,0,25,1.23Z" fill="currentColor"></path></svg></a></li>
            <li><a class="poxy-icon sponsor poxy-external" href="https://github.com/sponsors/marzer" target="_blank" title="Become a sponsor"><svg id="poxy-icon-sponsor" version="1.1" viewBox="0 0 66.911 66.911" xmlns="http://www.w3.org/2000/svg"><path d="M66.911,22.831c0-10.563-8.558-19.122-19.118-19.122c-5.658,0-10.721,2.473-14.223,6.377  c-0.037,0.043-0.076,0.085-0.113,0.128c-3.5-3.98-8.618-6.505-14.334-6.505C8.561,3.709,0.005,12.268,0,22.831  c0,5.834,2.629,11.059,6.758,14.565H6.751l27.104,25.806l26.308-25.806h-0.012C64.279,33.89,66.911,28.669,66.911,22.831z" fill="currentColor"></path></svg></a></li>
            <li><a class="poxy-icon theme" href="javascript:void(null);" id="poxy-theme-switch" onclick="toggle_theme(); return false;" role="button" title="Toggle dark and light themes"><svg id="poxy-theme-switch-img" version="1.1" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><circle cx="185.6708" cy="183.8122" fill="currentColor" r="65.625"></circle><path d="M185.6708,87.5622a13.1256,13.1256,0,0,0,13.125-13.125V52.5622a13.125,13.125,0,1,0-26.25,0v21.875A13.1257,13.1257,0,0,0,185.6708,87.5622Z" fill="currentColor"></path><path d="M99.051,115.7519a13.1236,13.1236,0,1,0,18.56-18.56L102.1442,81.726a13.1236,13.1236,0,0,0-18.5595,18.56Z" fill="currentColor"></path><path d="M89.4208,183.8122a13.1257,13.1257,0,0,0-13.125-13.125H54.4208a13.125,13.125,0,0,0,0,26.25h21.875A13.1256,13.1256,0,0,0,89.4208,183.8122Z" fill="currentColor"></path><path d="M99.051,251.8725,83.5847,267.3431a13.1236,13.1236,0,1,0,18.56,18.56l15.4663-15.4706a13.1236,13.1236,0,1,0-18.5595-18.56Z" fill="currentColor"></path><path d="M185.6708,280.0622a13.1258,13.1258,0,0,0-13.125,13.125v21.875a13.125,13.125,0,0,0,26.25,0v-21.875A13.1257,13.1257,0,0,0,185.6708,280.0622Z" fill="currentColor"></path><path d="M272.2907,251.8725a13.1236,13.1236,0,1,0-18.56,18.56l15.4663,15.4706a13.1236,13.1236,0,1,0,18.56-18.56Z" fill="currentColor"></path><path d="M330.0458,183.8122a13.1257,13.1257,0,0,0-13.125-13.125h-21.875a13.125,13.125,0,0,0,0,26.25h21.875A13.1256,13.1256,0,0,0,330.0458,183.8122Z" fill="currentColor"></path><path d="M263.0109,119.5971a13.0824,13.0824,0,0,0,9.28-3.8452l15.4663-15.4663a13.1236,13.1236,0,1,0-18.56-18.56L253.7312,97.1923a13.125,13.125,0,0,0,9.28,22.4048Z" fill="currentColor"></path><path d="M456.9379,401.6714a63.97,63.97,0,0,1-14.9963,7.2055c-19.6448,6.5283-41.8787,2.9566-58.1439-9.8523a68.9311,68.9311,0,0,1-10.835-10.8339c-12.8088-16.2663-16.3806-38.5-9.8523-58.1471a63.8444,63.8444,0,0,1,7.2077-14.9931,8.8036,8.8036,0,0,0-10.1172-13.3034,87.5188,87.5188,0,1,0,110.0372,110.04A8.8,8.8,0,0,0,456.9379,401.6714Z" fill="currentColor"></path></svg></a></li>
            <li class="m-show-m"><a class="m-doc-search-icon" href="#search" onclick="return showSearch()" title="Search"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path"></use>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          soagen: A Structure-of-Arrays generator for C++
        </h1>
        <nav class="m-block m-default poxy-toc" id="poxy-toc">
          <h3>Contents</h3>
          <ul>
            <li><a href="#intro_tldr">TL;DR</a></li>
            <li>
              <a href="#intro_motivation">Motivation</a>
              <ul>
                <li><a href="#intro_motivation_typical">Typical data layouts (Array-of-Structures)</a></li>
                <li>
                  <a href="#intro_motivation_soa">Structure-of-Arrays</a>
                  <ul>
                    <li><a href="#intro_motivation_soa_naive">A naïve implementation</a></li>
                    <li><a href="#intro_motivation_soa_multiple_allocation">Problem #1: Multiple allocations</a></li>
                    <li><a href="#intro_motivation_soa_manual_sync">Problem #2: Manual Synchronization</a></li>
                    <li><a href="#intro_motivation_soa_iterators_weakly_typed">Problem #3: Identities are weakly-typed</a></li>
                    <li><a href="#intro_motivation_soa_struct_mode_hard">Problem #4: AoS-style access is cumbersome</a></li>
                    <li><a href="#intro_motivation_soa_idiomatic">Problem #5: Not idiomatic C++</a></li>
                    <li><a href="#intro_motivation_soa_names">Problem #6: Elegance or Names - pick one</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#intro_introducing_soagen">Introducing soagen</a></li>
            <li>
              <a href="#intro_getting_started">Getting started</a>
              <ul>
                <li><a href="#intro_getting_started_prerequisites">Prerequisites</a></li>
                <li><a href="#intro_getting_started_generator">Installing soagen</a></li>
              </ul>
            </li>
            <li><a href="#intro_creating_a_class">Creating an SoA container class</a></li>
            <li><a href="#intro_installing_soagen_hpp">Installing soagen.hpp</a></li>
            <li><a href="#intro_configuring_includes">Configuring #includes</a></li>
            <li><a href="#intro_nomenclature">A brief aside: terminology</a></li>
            <li><a href="#intro_adding_rows">Adding rows</a></li>
            <li><a href="#intro_removing_rows">Removing rows</a></li>
            <li><a href="#intro_capacity">Capacity</a></li>
            <li><a href="#intro_columns">Working with columns</a></li>
            <li><a href="#intro_rows">Working with rows and iterators</a></li>
            <li><a href="#intro_equality">Equality</a></li>
            <li><a href="#intro_comparison">Comparison</a></li>
            <li><a href="#intro_custom_over_aligning_columns">Over-aligning columns</a></li>
            <li>
              <a href="#intro_custom_byo_allocator">Using custom allocators</a>
              <ul>
                <li>
                  <a href="#intro_customizing_allocators">Customizing allocators for soagen</a>
                  <ul>
                    <li><a href="#intro_customizing_allocators_min_alignment">Specifying a min_alignment</a></li>
                    <li><a href="#intro_customizing_allocators_aligned_allocate">Alignment-aware allocate()</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#intro_access_underlying_buffer">Accessing the underlying buffer</a></li>
            <li><a href="#intro_integration_with_reflection">Integrating with reflection systems</a></li>
            <li><a href="#intro_using_without_generator">Creating your own SoA types without the generator</a></li>
            <li><a href="#intro_next_steps">Next steps</a></li>
          </ul>
        </nav>
<section id="intro_tldr"><h2><a href="#intro_tldr">TL;DR</a></h2><p>The leading section of this page is an overview of what <a class="poxy-external" href="https://en.wikipedia.org/wiki/AoS_and_SoA" target="_blank">Structures-of-Arrays (SoA)</a> are, what problems they solve, and the annoyances of working with them in C++. Following that is an overview of <strong>soagen</strong> - a new Structure-Of-Arrays generator and library for C++17 and later.</p><p class="m-note m-success">Skip to <a class="m-doc" href="#intro_introducing_soagen">Introducing soagen</a> if you already know all about SoA and want to go straight to learning about <strong>soagen</strong> instead.</p></section><section id="intro_motivation"><h2><a href="#intro_motivation">Motivation</a></h2><section id="intro_motivation_typical"><h3><a href="#intro_motivation_typical">Typical data layouts (Array-of-Structures)</a></h3><p>Data records in a typical C++ program will be organized into <code>structs</code> and/or <code>classes</code>, one per 'unit' type, and multiples of these will be stored in arrays. For example, a program for managing employee records might contain something akin to this:</p><pre class="m-code"><span class="k">struct</span> <span class="nc">employee</span>
<span class="p">{</span>
    <span class="k">unsigned</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span> <span class="n">name</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">tuple</span><span class="o">&lt;</span><span class="k">unsigned</span> <span class="k">short</span><span class="p">,</span> <span class="k">unsigned</span> <span class="k">char</span><span class="p">,</span> <span class="k">unsigned</span> <span class="k">char</span><span class="o">&gt;</span> <span class="n">dob</span><span class="p">;</span>
    <span class="k">int</span> <span class="n">salary</span><span class="p">;</span>
    <span class="c1">// ... plus a bunch more</span>
<span class="p">};</span></pre><p>And elsewhere in the program you'd almost certainly find this:</p><pre class="m-code"><span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="nc">employee</span><span class="o">&gt;</span> <span class="n">employees</span><span class="p">;</span></pre><p>This paradigm is broadly called <a class="poxy-external" href="https://en.wikipedia.org/wiki/AoS_and_SoA" target="_blank">Array-of-Structures</a> (AoS). Stored this way, the all employee members are laid out sequentially in memory, so the <code>employees</code> array would look like this:</p><div class="inset_table" id="table_employees_layout"><table class="m-table"><thead><tr><th colspan="4">employees[0]</th><th colspan="4">employees[1]</th><th>→</th></tr></thead><tbody><tr><td><code>id</code></td><td><code>name</code></td><td><code>dob</code></td><td><code>salary</code></td><td><code>id</code></td><td><code>name</code></td><td><code>dob</code></td><td><code>salary</code></td><td>→</td></tr></tbody></table></div><p>When iterating over the <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a></code> depicted above, the CPU's cache will be mostly (or entirely) filled by only a single <code>employee</code> at all times. This is likely fine - most tasks pertaining to <code>employee</code> objects are going to want to access multiple data members, so the linear layout is useful. Rare would be the situation where you'd need to loop over the <code>employees</code> and fetch only a single field.</p><p>What about scenarios where you <em>do</em> want to only manipulate a single field from many objects, though? Let's say the <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a></code> example above had 1,000,000 <code>employee</code> elements and you wanted to query the total labour cost of your enormous company by summing up the <code>salary</code> member. Suddenly all those cache line misses start to add up and your <code>calculate_labour_cost()</code> routine is now much slower than you'd like.</p><p class="m-note m-default"><em>Yes, yes, you wouldn't use C++ for this. It'd be in SQL or similar. This is an example. Put down your pitchforks.</em></p><p>Still, in the general case, the access patterns for an <code>employee</code> would benefit from the current layout far more than any gains made by restructuring to solve this one specific problem (doing so is likely to pessimize the rest of the program). Also consider that calls to <code>calculate_labour_cost()</code> would be infrequent and the result could be cached, making this problem even less worth solving.</p><p>Let's have a look at a situation where the problem very much <em>is</em> worth solving.</p></section><section id="intro_motivation_soa"><h3><a href="#intro_motivation_soa">Structure-of-Arrays</a></h3><section id="intro_motivation_soa_naive"><h4><a href="#intro_motivation_soa_naive">A naïve implementation</a></h4><p>Consider a game engine: game worlds are populated by entities, those entities have various characteristics (position, orientation, mesh, id, name, et cetera). Suppose we had those encapsulated as an <code>entity</code> struct:</p><pre class="m-code"><span class="k">struct</span> <span class="nc">entity</span>
<span class="p">{</span>
    <span class="k">unsigned</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span> <span class="n">name</span><span class="p">;</span>
    <span class="nc">vec3</span> <span class="n">pos</span><span class="p">;</span>
    <span class="nc">quaternion</span> <span class="n">orient</span><span class="p">;</span>
    <span class="c1">// ... and so on</span>
<span class="p">};</span></pre><p>As before, lets have a look at what an array of these would look like in memory:</p><pre class="m-code"><span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span> <span class="nc">entities</span><span class="p">;</span></pre><div class="inset_table" id="table_entities_layout"><table class="m-table"><thead><tr><th colspan="4">entities[0]</th><th colspan="4">entities[1]</th><th>→</th></tr></thead><tbody><tr><td><code>id</code></td><td><code>name</code></td><td><code>pos</code></td><td><code>orient</code></td><td><code>id</code></td><td><code>name</code></td><td><code>pos</code></td><td><code>orient</code></td><td>→</td></tr></tbody></table></div><p>Game worlds feature many thousands of entities. Rendering these can be expensive, so great effort goes into ensuring the engine does not render anything unnecessarily. One technique for eliminating entities from the render list is to cull those that do not intersect with the camera's <a class="poxy-external" href="https://en.wikipedia.org/wiki/Viewing_frustum" target="_blank">view frustum</a>. This necessitates iterating over all the entities in the game world at least once every frame (assisted by a bounding volume hierarchy or other acceleration structure). Unlike the <code>employee</code> program above, taking constant cache misses during this iteration by reading in entire <code>entity</code> structs is potentially devastating to our frame time!</p><p>Ideally we want to <em>only</em> read in the parts of the entities we care about (e.g. <code>entity::pos</code>), without dragging anything else into the cache.</p><p>Enter: ✨️ <a class="poxy-external" href="https://en.wikipedia.org/wiki/AoS_and_SoA" target="_blank">Structure-of-Arrays</a>. ✨️</p><p>If we restructured our entities into a series of parallel <code><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/container/vector" target="_blank">std::vectors</a></code>, we could iterate over just the positions:</p><pre class="m-code"><span class="k">struct</span> <span class="nc">entities</span>
<span class="p">{</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="k">unsigned</span><span class="o">&gt;</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&gt;</span> <span class="n">name</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="nc">vec3</span><span class="o">&gt;</span> <span class="n">pos</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">vector</span><span class="o">&lt;</span><span class="nc">quaternion</span><span class="o">&gt;</span> <span class="n">orient</span><span class="p">;</span>
    <span class="c1">// ... and so on</span>
<span class="p">};</span></pre><p>Now our data is conceptually more like a table, with columns for each characteristic (stored contiguously), and rows for each individual element:</p><div class="inset_table" id="table_entities_layout_soa"><table class="m-table"><thead><tr><th></th><th>id</th><th>name</th><th>pos</th><th>orient</th></tr></thead><tbody><tr><th>element 0</th><td><code>id[0]</code></td><td><code>name[0]</code></td><td><code>pos[0]</code></td><td><code>orient[0]</code></td></tr><tr><th>element 1</th><td><code>id[1]</code></td><td><code>name[1]</code></td><td><code>pos[1]</code></td><td><code>orient[1]</code></td></tr><tr><th>element 2</th><td><code>id[2]</code></td><td><code>name[2]</code></td><td><code>pos[2]</code></td><td><code>orient[2]</code></td></tr><tr><th>↓</th><td>↓</td><td>↓</td><td>↓</td><td>↓</td></tr></tbody></table></div><p>We've lost the explicit <code>entity</code> class for representing one single game world entity, and have instead transitioned to an implicit object model where an entity is described by all the elements sharing the same index in the parallel <code><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/container/vector" target="_blank">std::vectors</a></code>. As well as being faster for single-element iteration, this also has another neat side-effect: no structs means no padding between struct members, so lower memory usage!</p><p>⚠️ There are some big problems with this naïve SoA implementation, though.</p></section><section id="intro_motivation_soa_multiple_allocation"><h4><a href="#intro_motivation_soa_multiple_allocation">Problem #1: Multiple allocations</a></h4><p>One heap allocation for each member <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a></code>. Sure we could come up with a custom <code>allocator</code> that works from the same internal buffer, but that's not for the faint of heart.</p><p class="m-note m-default"><em>No doubt there's some solution for this in <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/namespacestd_1_1pmr.html" target="_blank">std::<wbr/>pmr</a></code>. I'll leave that as an exercise for the reader.</em></p></section><section id="intro_motivation_soa_manual_sync"><h4><a href="#intro_motivation_soa_manual_sync">Problem #2: Manual Synchronization</a></h4><p>Now that we have multiple arrays, we must ensure that they are all updated in unison whenever we insert, modify, or delete elements. Forgetting to do this at any point will mean the parallel members are no longer in sync and lead to disastrous and hilarious effects.</p></section><section id="intro_motivation_soa_iterators_weakly_typed"><h4><a href="#intro_motivation_soa_iterators_weakly_typed">Problem #3: Identities are weakly-typed</a></h4><p>We no longer have the benefit of the strongly-typed <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>&lt;entity&gt;::iterator</code> (or even just the ability to take a pointer, <code>entity*</code>), so any time we need to store an association between a specific entity and some other thing, it needs to be done via an index (e.g. <code><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></code>). This is much more error-prone; it's all-too-easy to accidentally treat an index into one collection as an index into another.</p><p>Using a 'strong type' library (like <a class="poxy-external" href="https://github.com/rollbear/strong_type" target="_blank">this one</a>) or using an <code>enum class</code> can help here, but that still means you need <code>static_casts</code> (or some other conversion function) everywhere, which is <em>very annoying</em>.</p></section><section id="intro_motivation_soa_struct_mode_hard"><h4><a href="#intro_motivation_soa_struct_mode_hard">Problem #4: AoS-style access is cumbersome</a></h4><p>There will always be situations where you need to treat your SoA data as if it were AoS. Debug printing, for example. Code that needs to work in AoS mode is now littered with <code>operator[]</code> invocations, making it uglier and more error prone.</p></section><section id="intro_motivation_soa_idiomatic"><h4><a href="#intro_motivation_soa_idiomatic">Problem #5: Not idiomatic C++</a></h4><p>AoS-style data means we can call <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>&lt;&gt;::push_back()</code> to add an entirely new self-contained record. We can call <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/algorithm/sort.html" target="_blank">std::<wbr/>sort()</a></code> on the elements in that vector. We can get the <code>begin()</code> and <code>end()</code> iterators. And so on. These are idioms all C++ programmers are innately familiar with. SoA-style data can make these tasks much harder, typically necessitating a new set of internal idioms and reducing the understandability of the code.</p></section><section id="intro_motivation_soa_names"><h4><a href="#intro_motivation_soa_names">Problem #6: Elegance or Names - pick one</a></h4><p>There are a number of solutions for the problems described above floating around the internet. All of them boil down to one of two approaches:</p><ol><li>Most/all of the problems above are solved using a nice template syntax and some specialization tricks, but you lose the names of members and instead need to fall-back to the incredibly unfrendly <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/utility/tuple.html" target="_blank">std::<wbr/>tuple</a>-like <code>entities.get&lt;0&gt;()[N]</code>.</li><li>You get names, yay! But now your codebase is filled with macros, boo.</li></ol><p>Of the two options above, I generally prefer #2, though having to update lists of template specialization macros whenever you make changes to an SoA container is also a source of error. Without language-level reflection facilities, any solution with names is going to have macros <em>somewhere</em> (or make sacrifices elsewhere, e.g. mandating a very recent version of C++).</p><aside class="m-note m-special"><p>We're done explaining AoS vs SoA, but if these concepts were new for you and you'd like to learn more about them before you move on to read about <strong>soagen</strong>, here's some resources:</p><ul><li><a class="poxy-external" href="https://en.wikipedia.org/wiki/AoS_and_SoA" target="_blank">AoS and SoA</a> - Wikipedia</li><li><a class="poxy-external" href="https://blog.molecular-matters.com/2013/10/22/implementing-a-semi-automatic-structure-of-arrays-data-container/" target="_blank">Implementing a semi-automatic structure-of-arrays data container</a> - Molecular Matters</li><li><a class="poxy-external" href="https://www.intel.com/content/www/us/en/developer/articles/technical/memory-layout-transformations.html" target="_blank">Memory Layout Transformations</a> - Intel</li><li><a class="poxy-external" href="https://saturncloud.io/blog/structure-of-arrays-vs-array-of-structures-in-cuda/" target="_blank">Structure of Arrays vs Array of Structures in CUDA</a> - SaturnCloud</li></ul></aside></section></section></section><section id="intro_introducing_soagen"><h2><a href="#intro_introducing_soagen">Introducing soagen</a></h2><p>I'd to present my solution to the problems of working with Structure-of-Arrays in C++: <strong>soagen</strong>. Soagen is fundamentally two things:</p><ol><li><a class="poxy-external" href="https://pypi.org/project/soagen" target="_blank"><code>soagen</code></a>, a command-line code utility for generating bespoke <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a></code>-like SoA containers, and</li><li><a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a>, a single-header backing library upon which the generated code depends.</li></ol><p>Typically you only need to use the command-line tool <a class="poxy-external" href="https://pypi.org/project/soagen" target="_blank"><code>soagen</code></a>, and don't need to know anything about <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a> beyond <em>"this needs to be on my include path somewhere"</em> (since it's largely an implementation detail). You may need to learn more about the backing library if you're doing more advanced stuff, but we'll cover that later.</p><p>I'll go over how to use <a class="poxy-external" href="https://pypi.org/project/soagen" target="_blank"><code>soagen</code></a>, and the code it generates, by demonstrating how to we'd use it to create a nice SoA version of the <code>entity</code> class <a href="#intro_motivation_soa_naive">described above</a>.</p><p class="m-note m-default"><em>I stylize the name as 'soagen' (all lowercase), only capitalizing the S when it's the first word in a sentence, but I don't feel strongly about it. Render it however you like, I'm not fussed. SoAgen, Soagen, SOAgen, whatever.</em></p><p class="m-note m-success">If you have no interest in using a command-line tool to generate SoA classes and instead want to build your own using <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a> directly, skip to <a class="m-doc" href="#intro_using_without_generator">Creating your own SoA types without the generator</a>. The rest of the page is probably worth a read just for context, though.</p></section><section id="intro_getting_started"><h2><a href="#intro_getting_started">Getting started</a></h2><section id="intro_getting_started_prerequisites"><h4><a href="#intro_getting_started_prerequisites">Prerequisites</a></h4><ul><li>Using the generator: Python 3.9 or higher</li><li>Using the C++ library and/or generated code: C++17 or later</li></ul></section><section id="intro_getting_started_generator"><h4><a href="#intro_getting_started_generator">Installing soagen</a></h4><p><a class="poxy-external" href="https://pypi.org/project/soagen" target="_blank"><code>soagen</code></a> is a command-line application written in Python. Install it using <code>pip</code>:</p><pre class="m-code m-console">&gt; pip install soagen</pre><p>After that, let's take a look at the help output:</p><pre class="m-code m-console">&gt; soagen --help

usage: soagen [-h] [-v] [--version] [--install &lt;dir&gt;] [--werror | --no-werror]
              [--color | --no-color] [--clang-format | --no-clang-format]
              [--doxygen | --no-doxygen] [--natvis | --no-natvis] [--bug-report]
              [configs ...]

  ___  ___   __ _  __ _  ___ _ __
 / __|/ _ \ / _` |/ _` |/ _ \ '_ \
 \__ \ (_) | (_| | (_| |  __/ | | |
 |___/\___/ \__,_|\__, |\___|_| |_|
                   __/ |
                  |___/   v0.4.0 - marzer.github.io/soagen

Struct-of-Arrays generator for C++ projects.

positional arguments:
  configs               zero or more .toml files describing your structures-of-arrays
                        (wildcards are accepted, e.g. soa/*.toml)

options:
  -h, --help            show this help message and exit
  -v, --verbose         enable very noisy diagnostic output
  --version             print the version and exit
  --install &lt;dir&gt;       install soagen.hpp into a directory
  --werror, --no-werror
                        treat warnings as errors (default: False)
  --color, --no-color   use colors in terminal output (default: True)
                        (the British spelling "colour" is also accepted)
  --clang-format, --no-clang-format
                        attempt to run clang-format on generated code (default: True)
  --doxygen, --no-doxygen
                        include doxygen markup in the generated code (default: False)
  --natvis, --no-natvis
                        generate .natvis files for Visual Studio (default: True)
  --bug-report          capture all inputs and outputs in a bug-report zip file</pre><p>So we need to do two things:</p><ol><li>Tell <code>soagen</code> about the structs we want via a <code>.toml</code> file</li><li>Install <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a> somewhere (e.g. <code>my_game/src</code>)</li></ol></section></section><section id="intro_creating_a_class"><h2><a href="#intro_creating_a_class">Creating an SoA container class</a></h2><p><code>soagen</code> creates the output <code>XXXX.hpp</code> next to each <code>XXXX.toml</code> input you pass in. Given a game engine project with a fairly standard file structure:</p><pre class="m-code">docs/
include/
    quaternion.hpp
    vector.hpp
    ...
src/
README.md
... etc</pre><p>...if we want <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank"><code>entities.hpp</code></a> to end up in <code>src/</code> because it's an implementation detail, then that's where the <code>soagen</code> configuration file <code>entities.toml</code> should go, too. Let's create <code>src/entities.toml</code> and populate it thus:</p><pre class="m-code"><span class="n">namespace</span> <span class="o">=</span> <span class="s">'game'</span>

<span class="k">[structs.entities]</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span>     <span class="n">type</span> <span class="o">=</span> <span class="s">'unsigned'</span> <span class="p">},</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'name'</span><span class="p">,</span>   <span class="n">type</span> <span class="o">=</span> <span class="s">'<a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/string/basic_string" target="_blank">std::string</a>'</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="s">'""'</span> <span class="p">},</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'pos'</span><span class="p">,</span>    <span class="n">type</span> <span class="o">=</span> <span class="s">'vec3'</span><span class="p">,</span>        <span class="n">default</span> <span class="o">=</span> <span class="s">'{}'</span> <span class="p">},</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'orient'</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">'quaternion'</span><span class="p">,</span>  <span class="n">default</span> <span class="o">=</span> <span class="s">'{1, 0, 0, 0}'</span> <span class="p">},</span>
<span class="p">]</span></pre><p class="m-note m-default"><em>There are many more options in the <a class="m-doc" href="schema.html">Config File Schema</a> but for now we'll just stick with the basics.</em></p><p>Now run <code>soagen</code>:</p><pre class="m-code m-console">&gt; soagen src/*.toml

soagen v0.4.0
Reading src/entities.toml
Running clang-format for src/entities.hpp
Writing src/entities.hpp
Writing src/entities.natvis
All done!</pre><p>We now have <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank"><code>src/entities.hpp</code></a> containing the definition of <code>game::entities</code>, a <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>-like SoA container class (<a href="classsoagen_1_1examples_1_1entities.html">here's the documentation</a> if you'd like to see the API).</p><aside class="m-note m-info"><h4>Note</h4><p>Soagen has also generated a <a class="poxy-external" href="https://learn.microsoft.com/en-us/visualstudio/debugger/create-custom-views-of-native-objects?view=vs-2022#BKMK_Using_Natvis_files" target="_blank"><code>.natvis</code></a> file for working with Visual Studio, though this isn't mandatory - it can be disabled by passing <code>--no-natvis</code>.</p></aside><p>Our project now looks like this:</p><pre class="m-code">docs/
include/
    quaternion.hpp
    vector.hpp
src/
    entities.hpp     &lt;
    entities.natvis  &lt;----- new
    entities.toml    &lt;
README.md</pre></section><section id="intro_installing_soagen_hpp"><h2><a href="#intro_installing_soagen_hpp">Installing soagen.hpp</a></h2><p>Inspecting the contents of <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank"><code>entities.hpp</code></a>, we see that right near the top it expects to be able to <code>#include &lt;<a class="m-doc" href="soagen_8hpp.html">soagen.hpp</a>&gt;</code>. This means we need to 'install' it somewhere. The command-line utility is responsible for that, too:</p><pre class="m-code m-console">&gt; soagen --install src

soagen v0.4.0
Copying soagen.hpp to src
All done!</pre><p>Our project now looks like this:</p><pre class="m-code">docs/
include/
    quaternion.hpp
    vector.hpp
src/
    entities.hpp
    entities.natvis
    entities.toml
    soagen.hpp    &lt;----- new
README.md</pre><p>You can also combine the source generation and install steps in the same command invocation:</p><pre class="m-code m-console">&gt; soagen src/*.toml --install src</pre><p>This is the same as doing them both separately.</p><aside class="m-note m-info"><h4>Note</h4><p><a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a> does not have to be installed inside your source tree, of course. You could install it wherever you like. It does make sense to keep it side-by-side with your generated code, though, because the generated code is always going make fairly exacting assumptions about the version of the header it was paired with.</p></aside></section><section id="intro_configuring_includes"><h2><a href="#intro_configuring_includes">Configuring #includes</a></h2><p>Taking another look at the contents of <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank"><code>entities.hpp</code></a>, we see that <code>soagen</code> has detected the use of <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/string/basic_string.html" target="_blank">std::<wbr/>string</a></code> in the class interface and automatically added <code>#include &lt;string&gt;</code> for us. This will work for most standard library types (please <a class="poxy-external" href="https://github.com/marzer/soagen/issues" target="_blank">file a bug report</a> if not!), but not for types specific to our codebase. This means that we'd need to add an <code>#include</code> to make the <code>vec3</code> and <code>quaternion</code> types visible. Fortunately <code>soagen</code> knows how to do that.</p><p>Assuming that these math types live in <code>include/vector.hpp</code> and <code>include/quaternion.hpp</code>, and <code>include/</code> is configured as one our include paths in our project build system, then we need to add the following to our <code>entities.toml</code>:</p><pre class="m-code"><span class="k">[hpp]</span>
<span class="n">includes</span><span class="p">.</span><span class="n">internal</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'vector.hpp'</span><span class="p">,</span>
    <span class="s">'quaternion.hpp'</span>
<span class="p">]</span></pre><p>After regenerating <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank"><code>entities.hpp</code></a> we'll see this:</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">"vector.hpp"</span>
<span class="cp">#include</span> <span class="cpf">"quaternion.hpp"</span></pre><p>Now the compiler will be happy and we can start writing some code :)</p><aside class="m-note m-info"><h4>Note</h4><p><code>includes.internal</code> is, as the name suggests, for <code>#includes</code> that are internal to your project - they use the double-quoted form of include directives (e.g. <code>#include "foo.hpp"</code>). There also exists <code>includes.external</code> for things that are external to your project - these will use the angle-bracket form <code>#include &lt;foo.hpp&gt;</code>.</p></aside></section><section id="intro_nomenclature"><h2><a href="#intro_nomenclature">A brief aside: terminology</a></h2><p>From here down there will be a slight change in terminology:</p><div class="inset_table" id="table_terminology"><table class="m-table"><thead><tr><th>What I say</th><th>What it means</th></tr></thead><tbody><tr><td>Table</td><td><code>soagen</code>-generated SoA container class</td></tr><tr><td>Column</td><td>A contiguous subarray of one data type inside a <code>soagen</code>-generated SoA container class</td></tr><tr><td>Row</td><td>A single 'element' in a <code>soagen</code>-generated SoA container class</td></tr></tbody></table></div></section><section id="intro_adding_rows"><h2><a href="#intro_adding_rows">Adding rows</a></h2><p>Now then, lets do what we came here to do: stick entities in our new container! Tables have all the same insertion operations as <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>, only with multiple parameters:</p><pre class="m-code"><span class="c1">// assuming you have #included "entities.hpp" somewhere:</span>

<span class="nn">game</span><span class="o">::</span><span class="nc">entities</span> <span class="n">e</span><span class="p">;</span>

<span class="c1">// push_back works as you'd expect</span>
<span class="n">e</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"foo"</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>

<span class="c1">// it will also take advantage of the defaults</span>
<span class="c1">// we specified in the config, allowing us to elide</span>
<span class="c1">// some initializers:</span>
<span class="n">e</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"bar"</span><span class="p">);</span>

<span class="c1">// insert has the same semantics too</span>
<span class="n">e</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">end</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"qux"</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">});</span>

<span class="c1">// ... but can also take a size_type as the position</span>
<span class="c1">// argument, not just iterators</span>
<span class="n">e</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">(),</span> <span class="mi">3</span><span class="p">,</span> <span class="s">"kek"</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">row</span> <span class="o">:</span> <span class="n">e</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">0: foo</span>
<span class="go">1: bar</span>
<span class="go">2: qux</span>
<span class="go">3: kek</span></pre><p>We also have <code>emplace()</code> and <code>emplace_back()</code> just like <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>, but there's a catch: the <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a></code> versions are variadic to allow for constructing a single value with any number of constructor arguments. Since we have multiple values per row, there's no way we can have a variadic <code>emplace()</code>/<code>emplace_back()</code> that somehow deduces which arguments go to which values. We need to add an extra level of indirection for that:</p><pre class="m-code"><span class="k">using</span> <span class="nn">soagen</span><span class="o">::</span><span class="nc">emplacer</span><span class="p">;</span>

<span class="c1">// emplacer is fast + lightweight - doesn't make any copies</span>
<span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nc">emplacer</span><span class="p">{</span> <span class="mi">10</span><span class="p">,</span> <span class="sc">'A'</span> <span class="p">},</span> <span class="nc">vec3</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="nc">quaternion</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">});</span>

<span class="c1">// other tuple-like types are fine;</span>
<span class="c1">// defaults work here too</span>
<span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nn">std</span><span class="o">::</span><span class="nc">tuple</span><span class="p">{</span> <span class="mi">10</span><span class="p">,</span> <span class="sc">'B'</span> <span class="p">});</span>

<span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">row</span> <span class="o">:</span> <span class="n">e</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">0: foo</span>
<span class="go">1: bar</span>
<span class="go">2: qux</span>
<span class="go">3: kek</span>
<span class="go">4: AAAAAAAAAA</span>
<span class="go">5: BBBBBBBBBB</span></pre><p>You're not limited to manually enumerating all the arguments when you call <code>emplace_back()</code> and <code>emplace()</code> - you can also unpack any type that implements the <a class="poxy-cppreference poxy-external" href="https://en.cppreference.com/w/cpp/language/structured_binding" target="_blank">tuple protocol</a> to describe the whole row at once:</p><pre class="m-code"><span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="nn">std</span><span class="o">::</span><span class="nc">tuple</span><span class="p">{</span> <span class="s">"CCCCCCCCCC"</span><span class="p">,</span> <span class="nc">vec3</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="nc">quaternion</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span> <span class="p">});</span>

<span class="c1">// nesting tuples works too!</span>
<span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="nn">std</span><span class="o">::</span><span class="nc">tuple</span><span class="p">{</span> <span class="s">"DDDDDDDDDD"</span><span class="p">,</span> <span class="nn">std</span><span class="o">::</span><span class="nc">tuple</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">},</span> <span class="nc">quaternion</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">}</span> <span class="p">});</span>

<span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">row</span> <span class="o">:</span> <span class="n">e</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">0: foo</span>
<span class="go">1: bar</span>
<span class="go">2: qux</span>
<span class="go">3: kek</span>
<span class="go">4: AAAAAAAAAA</span>
<span class="go">5: BBBBBBBBBB</span>
<span class="go">6: CCCCCCCCCC</span>
<span class="go">7: DDDDDDDDDD</span></pre></section><section id="intro_removing_rows"><h2><a href="#intro_removing_rows">Removing rows</a></h2><p>Soagen tables support <code>pop_back()</code>, <code>erase()</code> and <code>resize()</code> just like <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>, and also <a href="classsoagen_1_1examples_1_1entities.html#a117807c0fbe9e2ed2fbe39c9193ff231"><code>unordered_erase()</code></a> for fast erasure when order doesn't matter:</p><pre class="m-code"><span class="c1">// erase CCCCCCCCCC and DDDDDDDDDD - pop_back takes a 'num' param</span>
<span class="n">e</span><span class="p">.</span><span class="nf">pop_back</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">// erase BBBBBBBBBB</span>
<span class="n">e</span><span class="p">.</span><span class="nf">pop_back</span><span class="p">();</span>

<span class="c1">// erase AAAAAAAAAA</span>
<span class="n">e</span><span class="p">.</span><span class="nf">erase</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">end</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// erase kek (erase() also supports size_type)</span>
<span class="n">e</span><span class="p">.</span><span class="nf">erase</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// erase foo quickly using swap-and-pop:</span>
<span class="n">e</span><span class="p">.</span><span class="nf">unordered_erase</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">begin</span><span class="p">());</span>

<span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">row</span> <span class="o">:</span> <span class="n">e</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">row</span><span class="p">.</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">2: qux &lt;---- this was moved here by unordered_erase()</span>
<span class="go">1: bar</span></pre></section><section id="intro_capacity"><h2><a href="#intro_capacity">Capacity</a></h2><p>Soagen tables have <code>capacity()</code>, <code>max_capacity()</code>, <code>reserve()</code>, and <code>shrink_to_fit()</code> as you'd expect:</p><pre class="m-code"><span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"size: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"capacity: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">capacity</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>

<span class="n">e</span><span class="p">.</span><span class="nf">reserve</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"size: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"capacity: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">capacity</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>

<span class="n">e</span><span class="p">.</span><span class="nf">shrink_to_fit</span><span class="p">();</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"size: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"capacity: "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">capacity</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">size: 2</span>
<span class="go">capacity: 6</span>

<span class="go">size: 2</span>
<span class="go">capacity: 100</span>

<span class="go">size: 2</span>
<span class="go">capacity: 2</span></pre></section><section id="intro_columns"><h2><a href="#intro_columns">Working with columns</a></h2><p>Recall that our table has four columns:</p><ul><li><code>id: unsigned</code></li><li><code>name: <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/string/basic_string.html" target="_blank">std::<wbr/>string</a></code></li><li><code>pos: vec3</code></li><li><code>orient: quaternion</code></li></ul><p>Since we don't have just one element type like a <a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/container/vector.html" target="_blank">std::<wbr/>vector</a>, we don't access these via <code>data()</code> - you use their names! Each returns a pointer to their respective column's data:</p><pre class="m-code"><span class="k">for</span> <span class="p">(</span><span class="nn">std</span><span class="o">::</span><span class="nc"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"id "</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">id</span><span class="p">()[i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

<span class="k">for</span> <span class="p">(</span><span class="nn">std</span><span class="o">::</span><span class="nc"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"name "</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">": "</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="nf">name</span><span class="p">()[i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

<span class="c1">// ...and so on</span></pre><pre class="m-console"><span class="go">id 0: 2</span>
<span class="go">id 1: 1</span>
<span class="go">name 0: qux</span>
<span class="go">name 1: bar</span></pre></section><section id="intro_rows"><h2><a href="#intro_rows">Working with rows and iterators</a></h2><p>Soagen tables support treating rows as if they were regular AoS structs in their own right via <a class="m-doc" href="structsoagen_1_1row.html">soagen::<wbr/>row</a>. This is what you get from <code>operator[]</code>, <code>at()</code>, and by dereferencing <a class="m-doc poxy-injected" href="classsoagen_1_1iterator.html">soagen::iterators</a>.</p><p><strong>Rows have reference semantics</strong>; if we retrieve a row from a non-<code>const</code> lvalue reference to our <code>entities</code> table, we'll get a row filled with named lvalue references to the members. For example:</p><pre class="m-code"><span class="c1">// entities&amp;, operator[]</span>
<span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="c1">// fetches an instance of this:</span>
<span class="k">struct</span> <span class="nc">row</span>
<span class="p">{</span>
    <span class="k">unsigned</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">;</span>
    <span class="nc">vec3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">;</span>
    <span class="nc">quaternion</span><span class="o">&amp;</span> <span class="n">orient</span><span class="p">;</span>
<span class="p">};</span></pre><p>Similarly, if we took a row from a <code>const</code>-qualified lvalue reference to our <code>entities</code>, we'd get lvalue references to <code>const</code> members:</p><pre class="m-code"><span class="c1">// const entities&amp;, at():</span>
<span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="nn">std</span><span class="o">::</span><span class="nf">as_const</span><span class="p">(</span><span class="n">e</span><span class="p">).</span><span class="nf">at</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// fetches an instance of this:</span>
<span class="k">struct</span> <span class="nc">row</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">unsigned</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">;</span>
    <span class="k">const</span> <span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">;</span>
    <span class="k">const</span> <span class="nc">vec3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">;</span>
    <span class="k">const</span> <span class="nc">quaternion</span><span class="o">&amp;</span> <span class="n">orient</span><span class="p">;</span>
<span class="p">};</span></pre><p>Same applies for rvalues:</p><pre class="m-code"><span class="c1">// entities&amp;&amp;, dereferencing an iterator:</span>
<span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="nn">std</span><span class="o">::</span><span class="nf">move</span><span class="p">(</span><span class="n">e</span><span class="p">).</span><span class="nf">begin</span><span class="p">());</span>

<span class="c1">// fetches an instance of this:</span>
<span class="k">struct</span> <span class="nc">row</span>
<span class="p">{</span>
    <span class="k">unsigned</span><span class="o">&amp;&amp;</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&amp;&amp;</span> <span class="n">name</span><span class="p">;</span>
    <span class="nc">vec3</span><span class="o">&amp;&amp;</span> <span class="n">pos</span><span class="p">;</span>
    <span class="nc">quaternion</span><span class="o">&amp;&amp;</span> <span class="n">orient</span><span class="p">;</span>
<span class="p">};</span></pre><p>Note that <strong>rows don't have to be all-or-nothing</strong>; if you want a row view of just two of your members, you can call <a href="classsoagen_1_1examples_1_1entities.html#ac24830714a0cf3a0f677b77936a79e73"><code>row()</code></a> to specify the columns you want:</p><pre class="m-code"><span class="c1">// columns 0 and 1 of row 0</span>
<span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">row</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// fetches an instance of this:</span>
<span class="k">struct</span> <span class="nc">row</span>
<span class="p">{</span>
    <span class="k">unsigned</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">;</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">;</span>
<span class="p">};</span></pre><p>This is true of iterators as well:</p><pre class="m-code"><span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">begin</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span></pre><p>Any rows generated by dereferencing the iterator above will only have <code>id</code> and <code>name</code> members.</p><p>You can even rearrange the order of the columns if you need to do some swizzling:</p><pre class="m-code"><span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">row</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// fetches an instance of this:</span>
<span class="k">struct</span> <span class="nc">row</span>
<span class="p">{</span>
    <span class="nc">quaternion</span><span class="o">&amp;</span> <span class="n">orient</span><span class="p">;</span> <span class="c1">// column 3</span>
    <span class="nc">vec3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">;</span>          <span class="c1">// column 2</span>
    <span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">;</span>  <span class="c1">// column 1</span>
<span class="p">};</span></pre><p>Of course, using the raw column indices is quite susceptible to human error (particularly if you change the table members later), so tables all have a <code>columns</code> member enum with named constants for each column:</p><pre class="m-code"><span class="k">auto</span> <span class="n">row</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">begin</span><span class="o">&lt;</span><span class="n">entities</span><span class="o">::</span><span class="n">columns</span><span class="o">::</span><span class="n">id</span><span class="p">,</span> <span class="n">entities</span><span class="o">::</span><span class="n">columns</span><span class="o">::</span><span class="n">name</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span></pre><p>No matter the column configuration, a <a class="m-doc" href="structsoagen_1_1row.html">soagen::<wbr/>row</a> will implement the <a class="poxy-cppreference poxy-external" href="https://en.cppreference.com/w/cpp/language/structured_binding" target="_blank">tuple protocol</a> so you can use it with structured bindings and other fun template stuff:</p><pre class="m-code"><span class="k">auto</span> <span class="n">r</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">row</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">&gt;</span><span class="p">();</span>

<span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="p">[</span><span class="n">orient</span><span class="p">,</span> <span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>

<span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">member_0</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">();</span> <span class="c1">// orient</span>
<span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">member_1</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">();</span> <span class="c1">// id</span>

<span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">column_0</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">column</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">();</span>    <span class="c1">// id</span>
<span class="c1">// auto&amp;&amp; column_1 = r.column&lt;1&gt;(); // ERROR - r doesn't view column 1</span>
<span class="c1">// auto&amp;&amp; column_2 = r.column&lt;2&gt;(); // ERROR - r doesn't view column 2</span>
<span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="n">column_3</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">column</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">();</span>    <span class="c1">// orient</span></pre><p>Finally, since rows implement the <a class="poxy-cppreference poxy-external" href="https://en.cppreference.com/w/cpp/language/structured_binding" target="_blank">tuple protocol</a>, you can use them with <code>emplace_back()</code> and <code>emplace()</code>:</p><pre class="m-code"><span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// push a copy of row[0] onto the end of the table</span></pre><aside class="m-note m-default"><h4>See also</h4><ul><li><a class="m-doc" href="classsoagen_1_1iterator.html">soagen::<wbr/>iterator</a></li><li><a class="m-doc" href="structsoagen_1_1row.html">soagen::<wbr/>row</a></li></ul></aside></section><section id="intro_equality"><h2><a href="#intro_equality">Equality</a></h2><p>If all the column types implement the named requirement <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/EqualityComparable" target="_blank">EqualityComparable</a> (i.e. they have <code>operator==</code>), then so too do your tables:</p><pre class="m-code"><span class="nn">game</span><span class="o">::</span><span class="nc">entities</span> <span class="n">e1</span><span class="p">;</span>
<span class="nn">game</span><span class="o">::</span><span class="nc">entities</span> <span class="n">e2</span><span class="p">;</span>

<span class="n">e1</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"cat"</span><span class="p">);</span>

<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">==</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

<span class="n">e2</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"cat"</span><span class="p">);</span>

<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">==</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

<span class="n">e1</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"dog"</span><span class="p">);</span>

<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">==</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">false</span>
<span class="go">true</span>
<span class="go">false</span></pre><p>The same is true of rows; if all of the viewed members are <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/EqualityComparable" target="_blank">EqualityComparable</a>, then so too are the rows:</p><pre class="m-code"><span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">e2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">e1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">true</span>
<span class="go">false</span></pre><aside class="m-note m-info"><h4>Note</h4><p>Rows do not have to have come from a table that is entirely <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/EqualityComparable" target="_blank">EqualityComparable</a>; it only depends on whether or not their viewed columns are. You can take a row view of only a few columns of a much larger table, and so long as the viewed columns are <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/EqualityComparable" target="_blank">EqualityComparable</a>, so too is the resulting <a class="m-doc" href="structsoagen_1_1row.html">soagen::<wbr/>row</a> type.</p></aside></section><section id="intro_comparison"><h2><a href="#intro_comparison">Comparison</a></h2><p>Tables are comparable with operators <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code> and <code>&gt;=</code> if all their column types implement the named requirement <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/LessThanComparable" target="_blank">LessThanComparable</a> (i.e. they have <code>operator&lt;</code>). Comparison is done row-wise, with row members compared lexicographically:</p><pre class="m-code"><span class="nn">game</span><span class="o">::</span><span class="nc">entities</span> <span class="n">e1</span><span class="p">;</span>
<span class="nn">game</span><span class="o">::</span><span class="nc">entities</span> <span class="n">e2</span><span class="p">;</span>

<span class="n">e1</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"cat"</span><span class="p">);</span>
<span class="n">e2</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"cat"</span><span class="p">);</span>

<span class="n">e1</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"dog"</span><span class="p">);</span>
<span class="n">e2</span><span class="p">.</span><span class="nf">push_back</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"dog"</span><span class="p">);</span>

<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&lt;</span>  <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&lt;=</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&gt;</span>  <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&gt;=</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>

<span class="n">e2</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">name</span> <span class="o">=</span> <span class="s">"bird"</span><span class="p">;</span>

<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&lt;</span>  <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&lt;=</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&gt;</span>  <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&gt;=</span> <span class="n">e2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">false</span>
<span class="go">true</span>
<span class="go">false</span>
<span class="go">true</span>

<span class="go">true</span>
<span class="go">true</span>
<span class="go">false</span>
<span class="go">false</span></pre><aside class="m-note m-info"><h4>Note</h4><p>Just as with <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/EqualityComparable" target="_blank">EqualityComparable</a>, rows are <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/LessThanComparable" target="_blank">LessThanComparable</a> if their viewed members are, too. It does not depend on the source table.</p></aside></section><section id="intro_custom_over_aligning_columns"><h2><a href="#intro_custom_over_aligning_columns">Over-aligning columns</a></h2><p>Owing to its very nature, SoA-structured data is often used in contexts where memory alignment is important. One common example is SIMD; you may have a column of floats that need to be aligned on a 16, 32 or 64-byte boundary, according to whatever the minimum instruction set is you're targeting.</p><p>Soagen has support for this without you needing to come up with custom allocators or jump through any template hoops. Let's re-visit our <code>entities.toml</code> file from earlier, only this time, we're going to over-align the <code>pos</code> column by adding an <code>alignment</code>:</p><pre class="m-code"><span class="n">namespace</span> <span class="o">=</span> <span class="s">'game'</span>

<span class="p">[</span><span class="n">structs</span><span class="p">.</span><span class="nc">entities</span><span class="p">]</span>                                                 <span class="c1">#    |</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>                                                      <span class="c1">#    |</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'id'</span><span class="p">,</span>     <span class="n">type</span> <span class="o">=</span> <span class="s">'unsigned'</span> <span class="p">},</span>                         <span class="c1">#   \|/</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'name'</span><span class="p">,</span>   <span class="n">type</span> <span class="o">=</span> <span class="s">'<a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/string/basic_string" target="_blank">std::string</a>'</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="s">'""'</span> <span class="p">},</span>      <span class="c1">#    V</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'pos'</span><span class="p">,</span>    <span class="n">type</span> <span class="o">=</span> <span class="s">'vec3'</span><span class="p">,</span>        <span class="n">default</span> <span class="o">=</span> <span class="s">'{}'</span><span class="p">,</span> <span class="n">alignment</span> <span class="o">=</span> <span class="mi">32</span> <span class="p">},</span>
    <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s">'orient'</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">'quaternion'</span><span class="p">,</span>  <span class="n">default</span> <span class="o">=</span> <span class="s">'{1, 0, 0, 0}'</span> <span class="p">},</span>
<span class="p">]</span></pre><p>Re-generating the table now would see that the <code>entities::pos()</code> data pointer always returned a value that was aligned on an (at least) 32-byte boundary.</p><aside class="m-note m-info"><h4>Note</h4><p>This information is also propagated through to the compiler via <code>assume_aligned</code> hints all the way down. <em>Vectorizer go brrrrrr!</em></p></aside><p>It can also be the case that you need to advance through the table in 'aligned batches', where the start of each batch for each column has the same alignment as the value you specified in the config. Soagen has you covered here, too: tables have <a href="structsoagen_1_1table__traits.html#a7b18454ef28aa4279e1f1fc61bd15381"><code>aligned_stride</code></a> as a public constant:</p><pre class="m-code"><span class="k">constexpr</span> <span class="k">auto</span> <span class="n">stride</span> <span class="o">=</span> <span class="n">entities</span><span class="o">::</span><span class="n">aligned_stride</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">ptr</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">pos</span><span class="p">(),</span> <span class="n">end</span> <span class="o">=</span> <span class="n">ptr</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">();</span> <span class="n">ptr</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">;</span> <span class="n">ptr</span> <span class="o">+=</span> <span class="n">stride</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span></pre><p>Note that <code>&lt;your table&gt;::aligned_stride</code> <strong>is across <em>every</em> column</strong>; if you have multiple over-aligned columns, this value will be the lowest-common-multiple of <em>all</em> of their <code>aligned_strides</code>, such that stepping through by that amount would have them <em>all</em> correctly aligned. This value may be larger than you like; if you're really just interested in one column, you can fetch the <code>aligned_stride</code> for it specifically using <code>column_traits</code>:</p><pre class="m-code"><span class="k">constexpr</span> <span class="k">auto</span> <span class="n">stride</span> <span class="o">=</span> <span class="n">entities</span><span class="o">::</span><span class="n">column_traits</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;::</span><span class="n">aligned_stride</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">ptr</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">pos</span><span class="p">(),</span> <span class="n">end</span> <span class="o">=</span> <span class="n">ptr</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="nf">size</span><span class="p">();</span> <span class="n">ptr</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">;</span> <span class="n">ptr</span> <span class="o">+=</span> <span class="n">stride</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span></pre><aside class="m-note m-default"><h4>See also</h4><ul><li><a class="m-doc" href="structsoagen_1_1table__traits.html#a7b18454ef28aa4279e1f1fc61bd15381">soagen::<wbr/>table_traits::<wbr/>aligned_stride</a></li><li><a class="m-doc" href="structsoagen_1_1column__traits.html#a662bd935d7b9454d7f6751934185cdea">soagen::<wbr/>column_traits::<wbr/>aligned_stride</a></li></ul></aside></section><section id="intro_custom_byo_allocator"><h2><a href="#intro_custom_byo_allocator">Using custom allocators</a></h2><p>Soagen tables will use their own allocator by default: the <a class="m-doc" href="structsoagen_1_1allocator.html">soagen::<wbr/>allocator</a>. This is one of the mechanisms that allow soagen to propagate the nice alignment hints all the way through to your user code.</p><p>It is the default, but you're not stuck with it. You can change the allocator for any struct in your config like this:</p><pre class="m-code"><span class="n">allocator</span> <span class="o">=</span> <span class="s">'foo::allocator'</span> <span class="c1"># at root level to change it for all classes, or</span>

<span class="k">[structs.entity]</span>
<span class="n">allocator</span> <span class="o">=</span> <span class="s">'foo::fancy_allocator'</span> <span class="c1"># ...can also be overridden set per-struct</span></pre><p>The only requirements of your allocator are:</p><ul><li>It must properly implement the named requirement <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/Allocator" target="_blank">Allocator</a>, and</li><li>Have a <code>value_type</code> of <code>char</code>, <code>unsigned char</code> or <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/types/byte.html" target="_blank">std::<wbr/>byte</a></code>.</li></ul><section id="intro_customizing_allocators"><h3><a href="#intro_customizing_allocators">Customizing allocators for soagen</a></h3><p>Custom allocators may implement two soagen-specific extensions relating to memory alignment to assist the compiler with generating performant code:</p><section id="intro_customizing_allocators_min_alignment"><h4><a href="#intro_customizing_allocators_min_alignment">Specifying a min_alignment</a></h4><p>If you know that your allocator will never align allocations on a boundary smaller than a particular value (say, 64 bytes), you can make soagen aware of this by adding a constexpr constant called <code>min_alignment</code>. Example:</p><pre class="m-code"><span class="k">struct</span> <span class="nc">my_allocator</span>
<span class="p">{</span>
    <span class="k">inline</span> <span class="k">constexpr</span> <span class="nn">std</span><span class="o">::</span><span class="nc"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></span> <span class="n">min_alignment</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
<span class="p">}</span></pre><p>Soagen will then propagate this information to the tables where it may be of use to the compiler.</p></section><section id="intro_customizing_allocators_aligned_allocate"><h4><a href="#intro_customizing_allocators_aligned_allocate">Alignment-aware allocate()</a></h4><p>If your environment has some aligned-allocation facility you wish to make soagen aware of, you can do so by providing an alignment-aware overload of <code>allocate()</code> taking a <code><a class="m-doc-external poxy-cppreference poxy-external" href="http://en.cppreference.com/w/cpp/memory/new/align_val_t.html" target="_blank">std::<wbr/>align_val_t</a></code> for alignment:</p><pre class="m-code"><span class="k">struct</span> <span class="nc">my_allocator</span>
<span class="p">{</span>
    <span class="nc">value_type</span><span class="o">*</span> <span class="nf">allocate</span><span class="p">(</span><span class="nn">std</span><span class="o">::</span><span class="nc"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></span> <span class="n">size</span><span class="p">,</span> <span class="nn">std</span><span class="o">::</span><span class="nc">align_val_t</span> <span class="n">alignment</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">my_aligned_alloc_function</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="k"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/language/static_cast" target="_blank">static_cast</a></span><span class="o">&lt;</span><span class="nn">std</span><span class="o">::</span><span class="nc"><a class="m-doc poxy-injected poxy-external poxy-cppreference" href="https://en.cppreference.com/w/cpp/types/size_t" target="_blank">size_t</a></span><span class="o">&gt;</span><span class="p">(</span><span class="n">alignment</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span></pre><p>Soagen will choose this overload over any others if it is present.</p><aside class="m-note m-default"><h4>See also</h4><p><a class="m-doc" href="structsoagen_1_1allocator.html">soagen::<wbr/>allocator</a></p></aside></section></section></section><section id="intro_access_underlying_buffer"><h2><a href="#intro_access_underlying_buffer">Accessing the underlying buffer</a></h2><p>Soagen allocates one contiguous buffer for the entire table. If all the column types in your table are <a class="m-doc poxy-injected poxy-external poxy-cppreference poxy-named-requirement" href="https://en.cppreference.com/w/cpp/named_req/TriviallyCopyable" target="_blank">TriviallyCopyable</a> you'll be able to access the underlying buffer directly with <code>data()</code>, and determine it's size with <code>allocation_size()</code>, allowing you to serialize/deserialize it directly, stream it, hash it, et cetera.</p><aside class="m-note m-default"><h4>See also</h4><ul><li><a class="m-doc" href="classsoagen_1_1table.html#a52fe4c66a3106c8be26f43ec8cabd26c">soagen::<wbr/>table::<wbr/>data()</a></li><li><a class="m-doc" href="classsoagen_1_1table.html#a1aba4f539694195b84ab3109c03c9b8b">soagen::<wbr/>table::<wbr/>allocation_size()</a></li></ul></aside></section><section id="intro_integration_with_reflection"><h2><a href="#intro_integration_with_reflection">Integrating with reflection systems</a></h2><p>For lack of an in-language solution, C++ reflection systems are typically heavily based on stringification tricks, magic macros and source-code scanners (e.g. Unreal Engine's UnrealHeaderTool). Soagen has functionality specifically aimed at integration with these systems.</p><p>Firstly, each table class has a <code>constexpr</code> variable template for fetching the name of a column:</p><pre class="m-code"><span class="nn">std</span><span class="o">::</span><span class="nc">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"column 0 name: "</span> <span class="o">&lt;&lt;</span> <span class="n">entities</span><span class="o">::</span><span class="n">column_name</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></pre><pre class="m-console"><span class="go">column 0 name: id</span></pre><p>Additionally, the generator supports adding custom annotations and attributes to the generated table class so you can use things like UE's <code>UCLASS()</code>:</p><pre class="m-code"><span class="k">[structs.entities]</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span> <span class="s">'UCLASS()'</span> <span class="p">]</span>
<span class="n">header</span> <span class="o">=</span> <span class="s">'''</span>
<span class="s">GENERATED_BODY();</span>
<span class="s">'''</span>
<span class="n">default_constructible</span> <span class="o">=</span> <span class="s">'auto'</span> <span class="c1"># let GENERATED_BODY create the default ctor</span></pre><aside class="m-note m-default"><h4>See also</h4><ul><li>Schema: <a class="m-doc" href="schema.html#schema_structs_annotations">annotations</a></li><li>Schema: <a class="m-doc" href="schema.html#schema_structs_attributes">attributes</a></li></ul></aside></section><section id="intro_using_without_generator"><h2><a href="#intro_using_without_generator">Creating your own SoA types without the generator</a></h2><p>What if you don't want to use a command-line tool to generate code, and instead want to build your own SoA types? That's totally fine! <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/src/soagen/hpp/single/soagen.hpp" target="_blank"><code>soagen.hpp</code></a> was written with that use-case in mind.</p><p>If you take a look at the source code for any <code>soagen</code>-generated table class you'll see that pretty much every function call is a one-liner pass-through to the common underlying container type <a class="m-doc" href="classsoagen_1_1table.html">soagen::<wbr/>table</a>. The generated classes buy you named members, default arguments to <code>push_back()</code> etc., and the ability to use rows and iterators, but most of those could be adapted to custom types relatively simply using the existing machinery. Crack open one of the generated <code>.hpp</code> files (e.g. <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/examples/entities.hpp" target="_blank">entities.hpp</a>) to see for yourself.</p><p>To use a <a class="m-doc" href="classsoagen_1_1table.html">soagen::<wbr/>table</a> directly, you need to express it terms of <a class="m-doc" href="structsoagen_1_1table__traits.html">soagen::<wbr/>table_traits</a>, which is itself expressed in terms of <a class="m-doc" href="structsoagen_1_1column__traits.html">soagen::<wbr/>column_traits</a>. For example, to create a 'raw' verson of the entity table we've generated above:</p><pre class="m-code"><span class="k">using</span> <span class="nc">entities</span> <span class="o">=</span> <span class="nn">soagen</span><span class="o">::</span><span class="nc">table</span><span class="o">&lt;</span><span class="nn">soagen</span><span class="o">::</span><span class="nc">table_traits</span><span class="o">&lt;</span>
    <span class="nn">soagen</span><span class="o">::</span><span class="nc">column_traits</span><span class="o">&lt;</span><span class="k">unsigned</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nn">soagen</span><span class="o">::</span><span class="nc">column_traits</span><span class="o">&lt;</span><span class="nn">std</span><span class="o">::</span><span class="nc">string</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nn">soagen</span><span class="o">::</span><span class="nc">column_traits</span><span class="o">&lt;</span><span class="nc">vec3</span><span class="p">,</span> <span class="mi">32</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nn">soagen</span><span class="o">::</span><span class="nc">column_traits</span><span class="o">&lt;</span><span class="nc">quaternion</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;</span><span class="p">;</span>

<span class="nc">entities</span> <span class="n">e</span><span class="p">;</span>

<span class="n">e</span><span class="p">.</span><span class="nf">emplace_back</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span> <span class="c1">// etc</span></pre><p class="m-note m-success">The interface of <a class="m-doc" href="classsoagen_1_1table.html">soagen::<wbr/>table</a> is a little bit less 'furnished' than it's <code>soagen</code>-generated brethren. Making more features available without using the generator is on the <a class="poxy-external" href="https://github.com/marzer/soagen/issues/1" target="_blank">roadmap</a>, so support for this use-case will improve in future.</p><aside class="m-note m-default"><h4>See also</h4><ul><li><a class="m-doc" href="classsoagen_1_1table.html">soagen::<wbr/>table</a></li><li><a class="m-doc" href="structsoagen_1_1table__traits.html">soagen::<wbr/>table_traits</a></li><li><a class="m-doc" href="structsoagen_1_1column__traits.html">soagen::<wbr/>column_traits</a></li></ul></aside></section><section id="intro_next_steps"><h2><a href="#intro_next_steps">Next steps</a></h2><p>If all of this sounds like it would solve a problem for you, please consider giving soagen a try! I'm eager to see how people get on with it.</p><ul><li>A loose development roadmap can be found <a class="poxy-external" href="https://github.com/marzer/soagen/issues/1" target="_blank">here</a></li><li>Bug reports and feature requests can be made here <a class="poxy-external" href="https://github.com/marzer/soagen/issues" target="_blank">here</a></li><li>A contribution guide can be found <a class="poxy-external" href="https://github.com/marzer/soagen/blob/main/CONTRIBUTING.md" target="_blank">here</a></li></ul><p>Thanks!</p><div class="m-block m-badge m-primary poxy-about-the-author"><img alt="The Author" src="author.jpg"/> <h3>About the author</h3> <p>I'm <a class="poxy-external" href="https://github.com/marzer" target="_blank">Mark</a>. You might know me as the <a class="poxy-external" href="https://marzer.github.io/tomlplusplus/" target="_blank">toml++</a> guy. I write code. Some of it is alright. Almost all of it is C++. <span class="poxy-socials"><a class="poxy-external" href="https://github.com/marzer" target="_blank"><svg class="poxy-icon poxy-injected-svg" id="poxy-injected-svg-0" version="1.1" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg"><path d="M25,1.23a24.37,24.37,0,0,0-7.7,47.5C18.51,49,19,48.2,19,47.56s0-2.12,0-4.15c-6.78,1.47-8.21-3.27-8.21-3.27C9.61,37.33,8,36.58,8,36.58c-2.21-1.51.17-1.48.17-1.48a5.12,5.12,0,0,1,3.73,2.51c2.17,3.72,5.7,2.65,7.09,2a5.25,5.25,0,0,1,1.55-3.26c-5.41-.61-11.1-2.7-11.1-12A9.41,9.41,0,0,1,12,17.79a8.75,8.75,0,0,1,.24-6.45s2-.66,6.7,2.49a23.1,23.1,0,0,1,12.2,0c4.66-3.15,6.7-2.49,6.7-2.49A8.75,8.75,0,0,1,38,17.79a9.41,9.41,0,0,1,2.51,6.54c0,9.36-5.7,11.42-11.13,12a5.83,5.83,0,0,1,1.65,4.51c0,3.26,0,5.89,0,6.69,0,.65.44,1.41,1.68,1.17A24.38,24.38,0,0,0,25,1.23Z" fill="currentColor"></path></svg></a>
					<a class="poxy-external" href="https://twitter.com/marzer8789" target="_blank"><svg class="poxy-icon poxy-injected-svg" id="poxy-injected-svg-1" version="1.1" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg"><path d="M 50.0625 10.4375 C 48.214844 11.257813 46.234375 11.808594 44.152344 12.058594 C 46.277344 10.785156 47.910156 8.769531 48.675781 6.371094 C 46.691406 7.546875 44.484375 8.402344 42.144531 8.863281 C 40.269531 6.863281 37.597656 5.617188 34.640625 5.617188 C 28.960938 5.617188 24.355469 10.21875 24.355469 15.898438 C 24.355469 16.703125 24.449219 17.488281 24.625 18.242188 C 16.078125 17.8125 8.503906 13.71875 3.429688 7.496094 C 2.542969 9.019531 2.039063 10.785156 2.039063 12.667969 C 2.039063 16.234375 3.851563 19.382813 6.613281 21.230469 C 4.925781 21.175781 3.339844 20.710938 1.953125 19.941406 C 1.953125 19.984375 1.953125 20.027344 1.953125 20.070313 C 1.953125 25.054688 5.5 29.207031 10.199219 30.15625 C 9.339844 30.390625 8.429688 30.515625 7.492188 30.515625 C 6.828125 30.515625 6.183594 30.453125 5.554688 30.328125 C 6.867188 34.410156 10.664063 37.390625 15.160156 37.472656 C 11.644531 40.230469 7.210938 41.871094 2.390625 41.871094 C 1.558594 41.871094 0.742188 41.824219 -0.0585938 41.726563 C 4.488281 44.648438 9.894531 46.347656 15.703125 46.347656 C 34.617188 46.347656 44.960938 30.679688 44.960938 17.09375 C 44.960938 16.648438 44.949219 16.199219 44.933594 15.761719 C 46.941406 14.3125 48.683594 12.5 50.0625 10.4375 Z" fill="currentColor"></path></svg></a>
					<a class="poxy-external" href="mailto:mark.gillard@outlook.com.au" target="_blank"><svg class="poxy-icon poxy-injected-svg" fill="currentColor" id="poxy-injected-svg-2" version="1.1" viewBox="0 0 395 395" xmlns="http://www.w3.org/2000/svg"><g><polygon points="395,320.089 395,74.911 258.806,197.5  "></polygon><polygon points="197.5,252.682 158.616,217.682 22.421,340.271 372.579,340.271 236.384,217.682  "></polygon><polygon points="372.579,54.729 22.421,54.729 197.5,212.318  "></polygon><polygon points="0,74.911 0,320.089 136.194,197.5  "></polygon></g></svg></a></span></p></div></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">…</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input autocomplete="off" autofocus="autofocus" disabled="disabled" id="search-input" name="q" placeholder="Loading …" spellcheck="false" type="search"/>
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div class="m-text m-dim m-text-center" id="search-help">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">↓</span>
            / <span class="m-label m-dim">↑</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div class="m-text m-warning m-text-center" id="search-notfound">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script><script>install_mcss_search_shim();</script>
<script async="async" src="searchdata-v2.js"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        
<a class="poxy-external" href="https://github.com/marzer/soagen" target="_blank">GitHub</a>
• <a class="poxy-external" href="https://github.com/marzer/soagen/issues" target="_blank">Report an issue</a>
• <a class="sponsor poxy-external" href="https://github.com/sponsors/marzer" target="_blank">Become a sponsor</a>
• <a href="poxy_changelog.html">Changelog</a>
• <a class="poxy-external" href="https://github.com/marzer/soagen/blob/master/LICENSE" target="_blank">License</a>
• <a download="" href="soagen.tagfile.xml" target="_blank" type="text/xml">Doxygen tagfile</a>
<br/><br/>
Site generated using <a class="poxy-external" href="https://github.com/marzer/poxy/" target="_blank">Poxy</a>

      </div>
    </div>
  </div>
</nav></footer>


</body></html>